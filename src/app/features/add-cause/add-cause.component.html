<div class="page-container">
  <div class="carousel-section">
    <div class="carousel-container">
      <div class="carousel-slides">
        @for (image of carouselImages; track image; let i = $index) {
          <div class="carousel-slide" [class.active]="i === currentSlideIndex">
            <img [src]="image" [alt]="'Carousel image ' + (i + 1)" />
          </div>
        }
      </div>
      <div class="carousel-indicators">
        @for (image of carouselImages; track image; let i = $index) {
          <button
            class="indicator"
            [class.active]="i === currentSlideIndex"
            (click)="goToSlide(i)"
            [attr.aria-label]="'Go to slide ' + (i + 1)"
          ></button>
        }
      </div>
    </div>
  </div>

  <div class="form-section">
  <mat-card appearance="outlined" class="form-card">
    <mat-card-header>
      <mat-card-title>Create a New Cause</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="causeForm" (ngSubmit)="onSubmit()">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Title</mat-label>
          <input matInput formControlName="title" placeholder="Enter cause title" />
          @if (causeForm.get('title')?.hasError('required') && causeForm.get('title')?.touched) {
            <mat-error>Title is required</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Short Description</mat-label>
          <textarea
            matInput
            formControlName="shortDescription"
            placeholder="Brief description of the cause"
            rows="3"
          ></textarea>
          @if (causeForm.get('shortDescription')?.hasError('required') && causeForm.get('shortDescription')?.touched) {
            <mat-error>Short description is required</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Long Description</mat-label>
          <textarea
            matInput
            formControlName="longDescription"
            placeholder="Detailed description of the cause"
            rows="6"
          ></textarea>
          @if (causeForm.get('longDescription')?.hasError('required') && causeForm.get('longDescription')?.touched) {
            <mat-error>Long description is required</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Target Amount</mat-label>
          <input
            matInput
            type="number"
            formControlName="target"
            placeholder="Enter target amount"
            min="1"
          />
          <span matPrefix>$&nbsp;</span>
          @if (causeForm.get('target')?.hasError('required') && causeForm.get('target')?.touched) {
            <mat-error>Target amount is required</mat-error>
          }
          @if (causeForm.get('target')?.hasError('min') && causeForm.get('target')?.touched) {
            <mat-error>Target amount must be greater than 0</mat-error>
          }
        </mat-form-field>

        <div class="file-upload-section">
          <input
            type="file"
            accept="image/*"
            (change)="onFileSelected($event)"
            #fileInput
            class="file-input"
          />
          <div class="file-upload-controls">
            <button
              mat-raised-button
              type="button"
              (click)="fileInput.click()"
              class="file-button"
            >
              Choose Image
            </button>
            @if (selectedFileName) {
              <span class="file-name">{{ selectedFileName }}</span>
            }
          </div>
          @if (imageUrlError) {
            <div class="error-message">{{ imageUrlError }}</div>
          }
          @if (imagePreview) {
            <div class="image-preview">
              <img [src]="imagePreview" alt="Preview" />
            </div>
          }
        </div>

        @if (submitError) {
          <div class="error-message">{{ submitError }}</div>
        }

        <div class="actions">
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="causeForm.invalid || isSubmitting"
          >
            {{ isSubmitting ? 'Creating...' : 'Create Cause' }}
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
  </div>
</div>

