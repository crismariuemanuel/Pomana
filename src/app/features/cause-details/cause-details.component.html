@if (isLoading()) {
  <div class="container">Loading cause...</div>
} @else if (loadError()) {
  <div class="container not-found">
    <h2>{{ loadError() }}</h2>
    <a mat-stroked-button color="primary" routerLink="/">Back to Feed</a>
  </div>
} @else if (cause()) {
  <div class="container">
    <div class="hero">
      <img [src]="cause()?.imageUrl" [alt]="cause()?.title" loading="lazy" />
    </div>

    <div class="header">
      <h1>{{ cause()?.title }}</h1>
      <p class="short">{{ cause()?.shortDescription }}</p>
    </div>

    <div class="progress">
      <mat-progress-bar mode="determinate" [value]="progress()"></mat-progress-bar>
      <div class="raised">
        Raised {{ cause()?.raised | currency:'USD':'symbol-narrow':'1.0-0' }}
        of {{ cause()?.target | currency:'USD':'symbol-narrow':'1.0-0' }}
      </div>
    </div>

    <div class="body">
      <p>{{ cause()?.longDescription }}</p>
    </div>

    <!-- Owner Info Section (only visible to owner for pending/rejected causes) -->
    @if (showOwnerInfo()) {
      <mat-card class="owner-info-card">
        <mat-card-header>
          <mat-card-title>Your Cause Status</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="owner-status">
            <p><strong>Status:</strong> 
              <span class="status-badge status-{{ cause()?.status }}">
                {{ (cause()?.status || '').replace('_', ' ').toUpperCase() }}
              </span>
            </p>
            @if (cause()?.status === 'rejected' && cause()?.review_notes) {
              <div class="review-notes">
                <p><strong>Review Notes:</strong></p>
                <p class="notes-text">{{ cause()?.review_notes }}</p>
              </div>
            }
            @if (cause()?.status === 'pending_review') {
              <p class="pending-message">Your cause is currently under review. We'll notify you once it's been reviewed.</p>
            }
          </div>
        </mat-card-content>
      </mat-card>
    }

    <div class="actions">
      @if (isLoggedIn()) {
        <button mat-raised-button color="primary" (click)="openComingSoon()">Donate Now</button>
      } @else {
        <button 
          mat-raised-button 
          color="primary" 
          (click)="openComingSoon()"
          matTooltip="Please log in to donate"
          [matTooltipDisabled]="false">
          Donate Now
        </button>
      }
    </div>
  </div>
} @else {
  <div class="container not-found">
    <h2>Cause not found</h2>
    <p>The cause you are looking for does not exist.</p>
    <a mat-stroked-button color="primary" routerLink="/">Back to Feed</a>
  </div>
}
